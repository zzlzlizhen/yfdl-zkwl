<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.remote.history.dao.HistoryYearMapper">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.remote.history.entity.HistoryYear" id="BaseResultMap">
        <result property="yearId" column="year_id"/>
        <result property="deviceCode" column="device_code"/>
        <result property="dischargeCapacity" column="discharge_capacity"/>
        <result property="chargingCapacity" column="charging_capacity"/>
        <result property="chargingCurrent" column="charging_current"/>
        <result property="dischargeCurrent" column="discharge_current"/>
        <result property="batteryVoltage" column="battery_voltage"/>
        <result property="ambientTemperature" column="ambient_temperature"/>
        <result property="internalTemperature" column="internal_temperature"/>
        <result property="visitorsFlowrate" column="visitors_flowrate"/>
        <result property="inductionFrequency" column="induction_frequency"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <sql id="Base_Column_List" >
    mouth_id, device_code, discharge_capacity, charging_capacity, charging_current, discharge_current,discharge_current,battery_voltage,ambient_temperature,
    internal_temperature,visitors_flowrate,induction_frequency,meteorological,create_time
    </sql>

    <select id="queryHistoryYear" resultMap="BaseResultMap" resultType="java.lang.Integer">
        SELECT
            count(1)
        FROM
            history_year
        where device_code = #{deviceCode}
        and year(create_time) = #{year} and month(create_time) = #{month}
    </select>

    <update id="updateHistroyByCode" parameterType="com.remote.history.entity.HistoryYear">
      update history_year set
          discharge_capacity = discharge_capacity + #{historyYear.dischargeCapacity},
          charging_capacity = charging_capacity + #{historyYear.chargingCapacity},
          charging_current = charging_current + #{historyYear.dischargeCurrent},
          battery_voltage = battery_voltage + #{historyYear.batteryVoltage},
          ambient_temperature = ambient_temperature + #{historyYear.ambientTemperature},
          internal_temperature = internal_temperature + #{historyYear.internalTemperature},
          visitors_flowrate = visitors_flowrate + #{historyYear.visitorsFlowrate},
          induction_frequency = induction_frequency + #{historyYear.inductionFrequency}
          where device_code = #{historyYear.deviceCode}
    </update>
    

</mapper>